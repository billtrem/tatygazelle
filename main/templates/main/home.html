{% extends 'main/base.html' %}
{% load static %}
{% block content %}

<div class="carousel-container">

    <div class="carousel-wrapper desktop-carousel">

        <div class="carousel-slide">
            {% for image in images %}
                <div class="slide{% if forloop.first %} active{% endif %}">
                    <img src="{{ image.image.url }}" alt="{{ image.caption }}">
                </div>
            {% endfor %}
        </div>

        {% if images|length > 1 %}
            <button class="carousel-btn prev">&#10094;</button>
            <button class="carousel-btn next">&#10095;</button>
        {% endif %}
    </div>

    <!-- MOBILE LIST VIEW -->
    <div class="mobile-image-list">
        {% for image in images %}
            <img src="{{ image.image.url }}" alt="{{ image.caption }}">
        {% endfor %}
    </div>

</div>


<script>
// Only run carousel JS on desktop
if (window.innerWidth >= 900) {
    const slides = document.querySelectorAll('.slide');
    let index = 0;

    function showSlide(i) {
        slides.forEach((s, idx) => {
            s.style.display = idx === i ? "block" : "none";
        });
    }

    const prevBtn = document.querySelector('.prev');
    const nextBtn = document.querySelector('.next');

    if (prevBtn) prevBtn.onclick = () => {
        index = (index - 1 + slides.length) % slides.length;
        showSlide(index);
    };

    if (nextBtn) nextBtn.onclick = () => {
        index = (index + 1) % slides.length;
        showSlide(index);
    };

    document.addEventListener('keydown', e => {
        if (slides.length < 2) return;

        if (e.key === "ArrowLeft") {
            index = (index - 1 + slides.length) % slides.length;
            showSlide(index);
        }
        if (e.key === "ArrowRight") {
            index = (index + 1) % slides.length;
            showSlide(index);
        }
    });

    showSlide(index);
}

</script>

{% endblock %}
